<?xml version="1.0" encoding="iso-8859-1"?>

<!--
  Please see the license.html file included with this distribution for
  attribution and copyright information.
-->

<root>

    <template name="party_guide_role">
        <party_guide_role_contents />
    </template>

    <windowclass name="journey_party_members_item">
        <script>
            function onInit()
              -- Debug.console("party member init");
            end
            function update()
              -- Debug.console("party member update");
            end
        </script>
        <sheetdata>
            <genericcontrol name="rightanchor">
                <anchored height="0" width="0">
                    <top />
                    <right />
                </anchored>
            </genericcontrol>

            <button_idelete name="idelete">
                <anchored width="20" height="20">
                    <top offset="2" />
                    <right parent="rightanchor" anchor="left" relation="relative" offset="-5" />
                </anchored>
            </button_idelete>

            <linkfield name="party_member_link" source=".link">
                <anchored width="20" height="20">
                    <top offset="2" />
                    <right parent="idelete" anchor="left" offset="-5" />
                </anchored>
                <description field="party_member" />
                <closetoggle />
                <invisible />
                <script>
						function onInit()
							onValueChanged();
						end
						function onValueChanged()
							if isEmpty() then
								setVisible(false);
							else
								setVisible(true);
							end
                            local _, nodeId = getValue();
                            local c = DB.findNode(nodeId);
                            local nameNode = c.getChild("name");
                            if nameNode then
                                window.name.setValue(nameNode.getValue());
                            end
						end
                </script>
            </linkfield>
            <basicstring name="name">
                <!-- <bounds>15,30,-5,20</bounds> -->
                <anchored parent="" position="insidetopleft" height="20">
                    <left offset="10" />
                    <top offset="0" />
                    <!-- <right to="party_member_link" anchor="left" offset="-5" /> -->
                </anchored>
                <readonly />
                <!-- <labelres>journey_party_member_name_label</labelres> -->
            </basicstring>

        </sheetdata>
    </windowclass>

    <windowclass name="party_guide_role_contents">
        <script>
            function onDrop(x, y, draginfo)
                local bReadOnly = WindowManager.getReadOnlyState(getDatabaseNode());
                if bReadOnly then return; end
                RoleManager.handleAssignPartyRole("guide", draginfo)
            end
        </script>

        <sheetdata>
            <!-- <frame_char /> -->
            <genericcontrol name="rightanchor">
                <anchored height="0" width="0">
                    <top />
                    <right />
                </anchored>
            </genericcontrol>


            <!--
        <linkfield name="link">
            <anchored to="rightanchor" position="right" relation="relative" offset="-30,-10" width="20" />
            <description field="guide" />
            <closetoggle />
            <invisible />
            <script>
                function onInit()
                    onValueChanged();
                end
                function onValueChanged()
                    if isEmpty() then
                        setVisible(false);
                        name.setValue("");
                        skill_bonus.setValue("");
                        attr_bonus.setValue("");
                    else
                        setVisible(true);
                        local guide = getDatabaseNode()
                        name.setValue(guide.name);
                        skill_bonus.setValue(GameSystemManager.getGameSystemValue(guide, "guide_skill"));
                        attr_bonus.setValue(GameSystemManager.getGameSystemValue(guide, "guide_attr"));
                    end
                end
            </script>
        </linkfield>
-->
            <string_labeled name="name">
                <!-- <bounds>15,30,-5,20</bounds> -->
                <anchored parent="" position="insidetopleft" height="20">
                    <left offset="15" />
                    <top offset="30" />
                    <right to="link" offset="-5" />
                </anchored>
                <readonly />
                <labelres>journey_party_roles_guide_label</labelres>
            </string_labeled>
            <!--
        <basicnumber name="skill_bonus">
            <anchored to="name" height="20" width="40">
                <top />
                <bottom />
                <left anchor="right" />
            </anchored>
        </basicnumber>
        <basicnumber name="attr_bonus">
            <anchored to="skill_bonus" height="20" width="40">
                <top />
                <bottom />
                <left anchor="right" />
                <right parent="link" anchor="left" />
            </anchored>
        </basicnumber>
-->
        </sheetdata>
    </windowclass>

    <windowclass name="party_scout_role">
        <genericcontrol name="rightanchor">
            <anchored height="0" width="0">
                <top />
                <right />
            </anchored>
        </genericcontrol>
    </windowclass>

    <windowclass name="party_hunter_role">
        <genericcontrol name="rightanchor">
            <anchored height="0" width="0">
                <top />
                <right />
            </anchored>
        </genericcontrol>
    </windowclass>

    <windowclass name="party_lookout_role">
        <genericcontrol name="rightanchor">
            <anchored height="0" width="0">
                <top />
                <right />
            </anchored>
        </genericcontrol>
    </windowclass>

</root>
