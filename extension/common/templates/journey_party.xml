<?xml version="1.0" encoding="iso-8859-1"?>

<!--
  Please see the license.html file included with this distribution for
  attribution and copyright information.
-->

<root>

    <template name="party_guide_role">
        <party_guide_role_contents />
    </template>

    <windowclass name="journey_party_members_item">
        <script>
            function onInit()
              -- Debug.console("party member init");
            end
            function update()
              -- Debug.console("party member update");
            end
        </script>
        <sheetdata>
            <genericcontrol name="rightanchor">
                <anchored height="0" width="0">
                    <top />
                    <right />
                </anchored>
            </genericcontrol>

            <button_idelete name="idelete">
                <anchored width="20" height="20">
                    <top offset="2" />
                    <right parent="rightanchor" anchor="left" relation="relative" offset="-5" />
                </anchored>
            </button_idelete>

            <linkfield name="party_member_link" source=".link">
                <anchored width="20" height="20">
                    <top offset="2" />
                    <right parent="idelete" anchor="left" offset="-5" />
                </anchored>
                <description field="party_member" />
                <closetoggle />
                <invisible />
                <script>
						function onInit()
							onValueChanged();
						end
						function onValueChanged()
							if isEmpty() then
								setVisible(false);
							else
								setVisible(true);
                                local _, nodeId = getValue();
                                -- Debug.console(nodeId)
                                local c = DB.findNode(nodeId);
                                -- Debug.console(c)
                                local nameNode = c.getChild("name");
                                -- Debug.console(nameNode)
                                if nameNode then
                                    window.name.setValue(nameNode.getValue());
                                end
                                local percValue = GameSystemManager.getGameSystemValue(c, "perception")
-- Debug.console(percValue)
                                if percValue then
                                    window.perception.setValue(percValue)
                                end
                            end
						end
                </script>
            </linkfield>
            <basicstring name="name">
                <!-- <bounds>15,30,-5,20</bounds> -->
                <anchored parent="" position="insidetopleft" height="20">
                    <left offset="10" />
                    <top offset="0" />
                    <!-- <right to="party_member_link" anchor="left" offset="-5" /> -->
                </anchored>
                <readonly />
                <!-- <labelres>journey_party_member_name_label</labelres> -->
            </basicstring>
            <basicnumber name="exhaustion" source=".exhaustion">
                <anchored to="party_member_link" width="30" height="15">
                    <top />
                    <right anchor="left" offset="-10" />
                </anchored>
            </basicnumber>
            <basicstring name="perception" source=".perception">
                <anchored to="exhaustion" width="30" height="15">
                    <top />
                    <right anchor="left" offset="-10" />
                </anchored>
                <font>msgfont</font>
                <readonly />
            </basicstring>

        </sheetdata>
    </windowclass>

</root>
